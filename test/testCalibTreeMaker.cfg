process Test = {
# output level
  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  replace MessageLogger.cerr.threshold = "WARNING"

# input file(s)
#  include "Calibration/Examples/test/testSample.cff"
#  untracked PSet maxEvents = {untracked int32 input = -1}

#
# PoolSource
#
    untracked PSet maxEvents = {untracked int32 input = 1000}
    include "Calibration/CalibTreeMaker/test/EmptyPoolSource.cfi"
    include "Calibration/CalibTreeMaker/test/files_DESY_CSA07JetMET-Gumbo-B1-PDJetMET_Skims2.cfg"
#    include "Calibration/CalibTreeMaker/test/files_CSA07-Gumbo-B1-PDAllEvents-ReReco-100pb-Skims1-photonjets.cfg"
#    include "Calibration/CalibTreeMaker/test/files_CSA07-Chowder-A4-PDAllEvents-ReReco-100pb-Skims1-photonjets.cfg"
#    include "Calibration/CalibTreeMaker/test/files_CSA07-Stew-B2-PDAllEventsReReco-100pb-Skims1-photonjets.cfg"

# produce calib input
  include "Calibration/CalibTreeMaker/data/CalibTreeMaker.cff"

# You have to check out event weight producer cvs co -r V06-15-08-05 PhysicsTools/HepMCCandAlgos
    module csaweightproducer = CSA07EventWeightProducer {
	InputTag src = source
	
	# verbosity
	untracked bool talkToMe = false
	
	# overall luminosity normalization  (in pb-1) 
	double overallLumi = 100.
    }

#---------------------------------------------------------------
# replacements
#---------------------------------------------------------------

# photon jet sample

  replace photonCalIsolation.dRMin            =  0.20
  replace photonCalIsolation.dRMax            =  0.70
  replace photonJetSample.Photons             = correctedPhotons
  replace photonJetSample.Jets                = iterativeCone5CaloJets
  replace photonJetSample.GenJets             = iterativeCone5GenJetsPt10
  replace photonJetFilter.MinPhotonPt         =  0.
  replace photonJetFilter.MaxPhotonEta        =  2.5
  replace photonJetFilter.MinJetPt            =  0.
  replace photonJetFilter.MaxJetEta           =  5.
  replace photonJetFilter.MaxIsolation        =  2.
  replace photonJetFilter.MaxNonleadingJetsPt =  5.
  replace photonJetFilter.MaxSecondJetPt      =  5.
  replace photonJetFilter.MaxDeltaPhi         =  0.10
  replace photonJetFilter.Debug               = false

# track tower sample

  replace trackTrkIsolation.dRMax             =  0.5
  replace trackTowerSample.MaxIsolation       = 20.
  replace trackTowerSample.MinPt              = 10.
  replace trackTowerSample.MaxEta             =  3.
  replace trackTowerSample.MaxTrkLength       =  0.
  replace trackTowerSample.MaxChiSquare       =100.
  replace trackTowerSample.MinNumOfHits       =  5
  replace trackTowerSample.MaxDeltaPhi        =  0.1
  replace trackTowerSample.MaxDeltaEta        =  0.1
  replace trackTowerSample.GroupNTowers       =  1   

# calibration tree

  replace calibTreeMaker.OutputFile           ="JetJet_Gumbo.root"

  replace calibTreeMaker.PhotonJetTreeName    ="GammaJetTree"
  replace calibTreeMaker.PhotonJetJets        = photonJetSample:LeadingJet
  replace calibTreeMaker.PhotonJetGenJets     = photonJetSample:LeadingGenJet
  replace calibTreeMaker.PhotonJetPhotons     = photonJetSample:LeadingPhoton
  replace calibTreeMaker.PhotonJetGenPhotons  = photonJetSample:LeadingGenPhoton
  replace calibTreeMaker.PhotonJetMet         = met
  replace calibTreeMaker.WritePhotonJetTree   = false

  replace calibTreeMaker.TrackTowerTreeName   ="TrackTowerTree"
  replace calibTreeMaker.TrackTowerTracks     = trackTowerSample:IsolatedTrack
  replace calibTreeMaker.TrackTowerTowers     = trackTowerSample:AssociatedTowers
  replace calibTreeMaker.WriteTrackTowerTree  = false

  replace calibTreeMaker.JetJetTreeName     ="JetJetTree"
  replace calibTreeMaker.JetJetJets         = iterativeCone5CaloJets
  replace calibTreeMaker.JetJetGenJets      = iterativeCone5GenJetsPt10
  replace calibTreeMaker.JetJetMET          = met
  replace calibTreeMaker.etaMaxTag          = 1.5
  replace calibTreeMaker.etaMaxProbe        = 5.0
  replace calibTreeMaker.PtMin              = 1.
  replace calibTreeMaker.sumPtMaxFracThird  = 0.1
  replace calibTreeMaker.deltaPhiJetMax     = 0.15
  replace calibTreeMaker.deltaPhiMETMax     = 0.15
  replace calibTreeMaker.minEMF             = 0.10
  replace calibTreeMaker.maxEMF             = 0.90
  replace calibTreeMaker.WriteJetJetTree    = true

  #path p1 = {dump} 
  path p2 = {csaweightproducer} 
  #endpath p3 = {makePhotonJetTree}
  #endpath p3 = {makeTrackTowerTree}
  endpath p3 = {makeJetJetTree}

  schedule = {p2, p3}

#  endpath p = {makeTrackTowerTree}
#  endpath p = {makeAllTrees}

}
